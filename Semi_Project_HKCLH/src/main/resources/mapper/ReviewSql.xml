<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mapper.ReviewMapperInter">

<!-- INSERT -->
	<insert id="insertReview" parameterType="review">
		insert into review
		(rnum, pnum, rrate, rname, mid, rcontent, rphoto,
		rdate) values
		(
		#{rnum}, #{pnum}, #{rrate}, #{rname}, #{mid}, #{rcontent},
		#{rphoto}, now()
		)
	</insert>


<!-- 수정 -->
	<select id="getReview" parameterType="int" resultType="review">
		select *
		from review where rnum = #{rnum}
	</select>


<!-- 삭제 -->
	<delete id="deleteReview" parameterType="int">
		delete from review where
		rnum=#{rnum}
	</delete>

<!-- LIST -->
	<select id="getReviewList" resultType="review">
		select * from review order by rnum desc
	</select>
	
	
	<!-- 최신순 -->
	<select id="getReviewList_latest" resultType="review">
		select * from review order by rdate desc
	</select>
	
	
	
   <select id="getTotalReviewCount" resultType="int">
      select count(*) from review
   </select>	
   
   
   <!-- 평균 별점 계산 -->
	<select id="getAvgRrate" resultType="review">
		select pnum, AVG(rrate) from review group by pnum;
	</select>
	
	</mapper>